(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{756:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(8081),r=a(2149),i=a(9651),n=a(7950),o=a.n(n),l=a(2184),c=a(1018);let d=(0,c.A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),u=(0,c.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var h=a(5160),g=a(6810),f=a(8539);let m={};async function v(e){return m[e]}async function w(e){delete m[e]}async function p(e){let t=await v(e);if(!t)return{success:!1,message:"Invalid verification token"};if(new Date>t.expires)return await w(e),{success:!1,message:"Verification token has expired"};let a=await f.ds.getUsers(),s=a.findIndex(e=>e.email===t.email);return -1===s?{success:!1,message:"User not found"}:(a[s].emailVerified=!0,f.ds.updateUser(a[s].id,a[s]),await w(e),{success:!0,email:t.email,role:a[s].role})}var y=a(3688);function x(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)().get("token"),[a,n]=(0,r.useState)("loading"),[c,f]=(0,r.useState)(""),[m,v]=(0,r.useState)("");return(0,r.useEffect)(()=>{(async function(){if(!t){n("error"),f("No verification token provided");return}try{let e=await p(t);if(e.success){if(n("success"),v(e.email||""),e.email){let t=e.role||"client";(0,y.Ee)(e.email,t)}}else n("error"),f(e.message||"Verification failed")}catch(e){n("error"),f("An error occurred during verification"),console.error("Verification error:",e)}})()},[t]),(0,s.jsx)("div",{className:"container flex min-h-[calc(100vh-4rem)] flex-col items-center justify-center py-12",children:(0,s.jsxs)(g.Zp,{className:"mx-auto w-full max-w-md border-primary-gold/20 shadow-md",children:[(0,s.jsxs)(g.aR,{children:[(0,s.jsx)(g.ZB,{className:"text-2xl font-bold text-secondary-blue",children:"Email Verification"}),(0,s.jsx)(g.BT,{children:"loading"===a?"Verifying your email address...":"success"===a?"Your email has been verified":"Verification failed"})]}),(0,s.jsx)(g.Wu,{className:"text-center",children:"loading"===a?(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsx)(l.A,{className:"mx-auto h-12 w-12 animate-spin text-primary-gold"}),(0,s.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Please wait while we verify your email address..."})]}):"success"===a?(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsx)(d,{className:"mx-auto h-12 w-12 text-green-500"}),(0,s.jsx)("p",{className:"mt-4",children:"Your email address has been successfully verified!"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"You can now access all features of the Acting Europe platform."})]}):(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsx)(u,{className:"mx-auto h-12 w-12 text-red-500"}),(0,s.jsx)("p",{className:"mt-4",children:"Verification failed"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:c})]})}),(0,s.jsx)(g.wL,{className:"flex justify-center",children:"loading"===a?(0,s.jsx)(h.$,{disabled:!0,children:"Please wait..."}):"success"===a?(0,s.jsx)(h.$,{onClick:()=>e.push("/profile"),children:"Go to Your Profile"}):(0,s.jsx)(h.$,{variant:"outline",asChild:!0,children:(0,s.jsx)(o(),{href:"/auth/signup",children:"Return to Sign Up"})})})]})})}},1018:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(2149);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...h}=e;return(0,s.createElement)("svg",{ref:t,...n,width:r,height:r,stroke:a,strokeWidth:l?24*Number(o)/Number(r):o,className:i("lucide",c),...h},[...u.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let a=(0,s.forwardRef)((a,n)=>{let{className:l,...c}=a;return(0,s.createElement)(o,{ref:n,iconNode:t,className:i("lucide-".concat(r(e)),l),...c})});return a.displayName="".concat(e),a}},2184:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1018).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3484:(e,t,a)=>{"use strict";a.d(t,{F:()=>n});var s=a(6522);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=s.$,n=(e,t)=>a=>{var s;if((null==t?void 0:t.variants)==null)return i(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:n,defaultVariants:o}=t,l=Object.keys(n).map(e=>{let t=null==a?void 0:a[e],s=null==o?void 0:o[e];if(null===t)return null;let i=r(t)||r(s);return n[e][i]}),c=a&&Object.entries(a).reduce((e,t)=>{let[a,s]=t;return void 0===s||(e[a]=s),e},{});return i(e,l,null==t?void 0:null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:a,className:s,...r}=t;return Object.entries(r).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...o,...c}[t]):({...o,...c})[t]===a})?[...e,a,s]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},3688:(e,t,a)=>{"use strict";function s(){return"true"===localStorage.getItem("actingEurope_auth")}function r(){let e=localStorage.getItem("actingEurope_userRole");return"admin"===e||"super_admin"===e}function i(e,t){localStorage.setItem("actingEurope_auth","true"),localStorage.setItem("actingEurope_userEmail",e),localStorage.setItem("actingEurope_userRole",t),window.dispatchEvent(new Event("user-logged-in"))}function n(){localStorage.removeItem("actingEurope_auth"),localStorage.removeItem("actingEurope_userEmail"),localStorage.removeItem("actingEurope_userRole"),window.dispatchEvent(new Event("user-logged-out"))}a.d(t,{Ee:()=>i,cy:()=>n,qc:()=>r,wR:()=>s})},5160:(e,t,a)=>{"use strict";a.d(t,{$:()=>c});var s=a(8081),r=a(2149),i=a(8050),n=a(3484),o=a(7687);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,...d}=e,u=c?i.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:r,size:n,className:a})),ref:t,...d})});c.displayName="Button"},6810:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>o,wL:()=>u});var s=a(8081),r=a(2149),i=a(7687);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...r})});o.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});l.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},7687:(e,t,a)=>{"use strict";a.d(t,{cn:()=>i});var s=a(6522),r=a(4483);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},7980:(e,t,a)=>{Promise.resolve().then(a.bind(a,756))},8539:(e,t,a)=>{"use strict";a.d(t,{V:()=>s,ds:()=>r});class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}initializeDatabase(){}async getData(){console.log("getData method in DatabaseStorage called");try{let e="".concat("","/api/data");console.log("Fetching data from:",e);let t=await fetch(e);if(console.log("Response status for /api/data:",t.status),!t.ok)return console.error("Failed to fetch data:",t.statusText),{events:[],venues:[],bookings:[],users:[],news:[],theatres:[]};return await t.json()}catch(e){return console.error("Error fetching data in DatabaseStorage:",e),{events:[],venues:[],bookings:[],users:[],news:[],theatres:[]}}}async saveData(e){try{let t=await fetch("".concat("","/api/data"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));window.dispatchEvent(new CustomEvent("databaseUpdated",{detail:this}))}catch(e){console.error("Error saving database data:",e)}}async getEvents(){return(await this.getData()).events||[]}async addEvent(e){let t=await this.getData();t.events.push(e),await this.saveData(t)}async updateEvent(e,t){let a=await this.getData(),s=a.events.findIndex(t=>t.id===e);-1!==s&&(a.events[s]=t,await this.saveData(a))}async deleteEvent(e){let t=await this.getData();t.events=t.events.filter(t=>t.id!==e),await this.saveData(t)}async getVenues(){return(await this.getData()).venues||[]}async addVenue(e){let t=await this.getData();t.venues.push(e),await this.saveData(t)}async updateVenue(e,t){let a=await this.getData(),s=a.venues.findIndex(t=>t.id===e);-1!==s&&(a.venues[s]=t,await this.saveData(a))}async deleteVenue(e){let t=await this.getData();t.venues=t.venues.filter(t=>t.id!==e),await this.saveData(t)}async getTheatres(){return(await this.getData()).theatres||[]}async addTheatre(e){let t=await this.getData();t.theatres.push(e),await this.saveData(t)}async updateTheatre(e,t){let a=await this.getData(),s=a.theatres.findIndex(t=>t.id===e);if(-1!==s)return a.theatres[s]={...a.theatres[s],...t},await this.saveData(a),a.theatres[s]}async deleteTheatre(e){let t=await this.getData();t.theatres=t.theatres.filter(t=>t.id!==e),await this.saveData(t)}async getBookings(){return(await this.getData()).bookings||[]}async addBooking(e){let t=await this.getData(),a={...e,id:t.bookings.length>0?Math.max(...t.bookings.map(e=>e.id))+1:1,bookingDate:new Date().toISOString()};return t.bookings.push(a),await this.saveData(t),a}async updateBooking(e){let t=await this.getData(),a=t.bookings.findIndex(t=>t.id===e.id);if(-1!==a)return t.bookings[a]={...t.bookings[a],...e},await this.saveData(t),t.bookings[a]}async deleteBooking(e){let t=await this.getData();t.bookings=t.bookings.filter(t=>t.id!==e),await this.saveData(t)}async getUsers(){return(await this.getData()).users||[]}async addUser(e){let t=await this.getData();t.users.push(e),await this.saveData(t)}async updateUser(e,t){let a=await this.getData(),s=a.users.findIndex(t=>t.id===e);-1!==s&&(a.users[s]={...a.users[s],...t},await this.saveData(a))}async createUser(e,t,a,s,r,i,n){try{if((await this.getUsers()).find(t=>t.email===e))throw Error("User already exists");let o={id:Date.now().toString(),email:e,password:t,firstName:a,lastName:s,role:r,emailNotifications:i,marketingPreferences:n,createdAt:new Date().toISOString()};return await this.addUser(o),o}catch(e){throw e}}async deleteUser(e){let t=await this.getData(),a=t.users.length;return t.users=t.users.filter(t=>t.id!==e),await this.saveData(t),t.users.length<a}async getNews(){return(await this.getData()).news||[]}async addNews(e){let t=await this.getData();t.news.push(e),await this.saveData(t)}async updateNews(e,t){let a=await this.getData(),s=a.news.findIndex(t=>t.id===e);if(-1!==s)return a.news[s]={...a.news[s],...t},await this.saveData(a),a.news[s]}async deleteNews(e){let t=await this.getData();t.news=t.news.filter(t=>t.id!==e),await this.saveData(t)}async clearAllData(){await this.saveData({users:[],theatres:[],venues:[],events:[],bookings:[],news:[]})}constructor(){this.storageKey="actingEurope_database",this.initializeDatabase()}}let r=s.getInstance()},9651:(e,t,a)=>{"use strict";var s=a(4571);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[687,950,497,954,358],()=>t(7980)),_N_E=e.O()}]);