(()=>{var e={};e.id=318,e.ids=[318],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4761:()=>{},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},49692:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"005aa5f1737d83d6e9f88fe04d498fde3b2e1adf4b":()=>s.lo,"402f814af364afe50084bf9b21165a137130b555d1":()=>s.hG,"408e2b78905075ea7c6da576d3efe4ce3e8a292ff4":()=>s.ht,"60107e7f4dd5b027b141f787532378755f00940ecc":()=>s.v_,"7f0c2a20dbc7b6c4a619b5890a6e41efcab43d77c8":()=>s.Uf,"7f1c24daf38cb2151c0e835bab5f05dae081c817fc":()=>s.RJ,"7f2aaa2ba6bebc909c025c6cf9cd6b1622d4761c29":()=>s.$o,"7fb0a6407a0975390cee39c3e56131848650f040a1":()=>s.lf,"7fbe5b110a2067de610a40c664b654dd890e162efa":()=>s.kg,"7fef397480b45af943a71981aace980d42e21b152e":()=>s.$b});var s=a(91651)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68313:()=>{},77407:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>v,routeModule:()=>g,serverHooks:()=>h,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>b});var s={};a.r(s),a.d(s,{DELETE:()=>f,GET:()=>c,PUT:()=>l});var r=a(44713),n=a(18198),i=a(84557),o=a(91651),u=a(61768);let d=e=>{let t=e.headers.get("Authorization");if(console.log("Auth Header:",t),!t)return console.log("No Authorization header found."),!1;let a=t.replace("Bearer ","");console.log("Extracted User Role:",a);let s="super_admin"===a||"admin"===a;return console.log("Has Access:",s),s};async function c(e){if(!d(e))return u.NextResponse.json({message:"Unauthorized"},{status:401});try{let e=await (0,o.lo)();return u.NextResponse.json(e)}catch(e){return console.error("Error fetching users:",e),u.NextResponse.json({message:"Error fetching users"},{status:500})}}async function l(e){if(!d(e))return u.NextResponse.json({message:"Unauthorized"},{status:401});try{let{id:t,newRole:a}=await e.json();if(!t||!a)return u.NextResponse.json({message:"Missing required fields: id or newRole"},{status:400});let s=await (0,o.v_)(t,a);if(!s)return u.NextResponse.json({message:"User not found"},{status:404});return u.NextResponse.json(s)}catch(e){return console.error("Error updating user role:",e),u.NextResponse.json({message:"Error updating user role"},{status:500})}}async function f(e){if(!d(e))return u.NextResponse.json({message:"Unauthorized"},{status:401});try{let{id:t}=await e.json();if(!t)return u.NextResponse.json({message:"Missing user ID"},{status:400});if(!await (0,o.hG)(t))return u.NextResponse.json({message:"User not found"},{status:404});return u.NextResponse.json({message:"User deleted successfully"})}catch(e){return console.error("Error deleting user:",e),u.NextResponse.json({message:"Error deleting user"},{status:500})}}let g=new r.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:"app/api/users/route"},resolvedPagePath:"D:\\ActingEurope\\ActingEurope_dev\\ActingEurope_dev\\app\\api\\users\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:b,serverHooks:h}=g;function v(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:b})}},91651:(e,t,a)=>{"use strict";a.d(t,{Uf:()=>g,lf:()=>h,kg:()=>d,$b:()=>b,hG:()=>l,RJ:()=>f,ht:()=>u,lo:()=>o,$o:()=>p,v_:()=>c});var s={};a.r(s);var r=a(51572);a(23680);class n{constructor(){this.storageKey="actingEurope_database",this.initializeDatabase()}static getInstance(){return n.instance||(n.instance=new n),n.instance}initializeDatabase(){}getData(){return{events:[],venues:[],bookings:[],users:[],news:[]}}saveData(e){}getEvents(){return this.getData().events}addEvent(e){let t=this.getData();t.events.push(e),this.saveData(t)}updateEvent(e,t){let a=this.getData(),s=a.events.findIndex(t=>t.id===e);-1!==s&&(a.events[s]=t,this.saveData(a))}deleteEvent(e){let t=this.getData();t.events=t.events.filter(t=>t.id!==e),this.saveData(t)}getVenues(){return this.getData().venues}addVenue(e){let t=this.getData();t.venues.push(e),this.saveData(t)}updateVenue(e,t){let a=this.getData(),s=a.venues.findIndex(t=>t.id===e);-1!==s&&(a.venues[s]=t,this.saveData(a))}deleteVenue(e){let t=this.getData();t.venues=t.venues.filter(t=>t.id!==e),this.saveData(t)}getBookings(){return this.getData().bookings}addBooking(e){let t=this.getData();t.bookings.push(e),this.saveData(t)}getUsers(){return this.getData().users}addUser(e){let t=this.getData();t.users.push(e),this.saveData(t)}getNews(){return this.getData().news}addNews(e){let t=this.getData();t.news.push(e),this.saveData(t)}clearAllData(){}updateUser(e){let t=this.getData(),a=t.users.findIndex(t=>t.id===e.id);-1!==a&&(t.users[a]=e,this.saveData(t))}}n.getInstance();var i=a(47608);async function o(){return s.DatabaseStorage.getInstance().getUsers()}async function u(e){let t=s.DatabaseStorage.getInstance();return(await t.getUsers()).find(t=>t.email===e)}let d=async(e,t,a)=>{let r=s.DatabaseStorage.getInstance();if((await r.getUsers()).find(t=>t.email===e))throw Error("User with this email already exists.");let n={id:Date.now().toString(),email:e,password:t,role:a,createdAt:new Date().toISOString()};return r.addUser(n),n};async function c(e,t){let a=s.DatabaseStorage.getInstance(),r=await a.getUsers(),n=r.findIndex(t=>t.id===e);if(-1===n)throw Error("User not found");return a.updateUser(e,{...r[n],role:t}),{...r[n],role:t}}async function l(e){return s.DatabaseStorage.getInstance().deleteUser(e)}let f=async()=>s.DatabaseStorage.getInstance().getNews(),g=async(e,t,a,r,n)=>{let i=s.DatabaseStorage.getInstance(),o={id:Date.now().toString(),title:e,excerpt:t,imageUrl:a,date:r,category:n};return i.addNews(o),o},p=async(e,t)=>s.DatabaseStorage.getInstance().updateNews(e,t),b=async e=>s.DatabaseStorage.getInstance().deleteNews(e),h=async(e,t)=>{let a=s.DatabaseStorage.getInstance();if((await a.getUsers()).find(e=>"super_admin"===e.role))throw Error("Super admin already exists.");let r={id:Date.now().toString(),email:e,password:t,role:"super_admin",createdAt:new Date().toISOString()};return a.addUser(r),r};(0,i.D)([o,u,d,c,l,f,g,p,b,h]),(0,r.A)(o,"005aa5f1737d83d6e9f88fe04d498fde3b2e1adf4b",null),(0,r.A)(u,"408e2b78905075ea7c6da576d3efe4ce3e8a292ff4",null),(0,r.A)(d,"7fbe5b110a2067de610a40c664b654dd890e162efa",null),(0,r.A)(c,"60107e7f4dd5b027b141f787532378755f00940ecc",null),(0,r.A)(l,"402f814af364afe50084bf9b21165a137130b555d1",null),(0,r.A)(f,"7f1c24daf38cb2151c0e835bab5f05dae081c817fc",null),(0,r.A)(g,"7f0c2a20dbc7b6c4a619b5890a6e41efcab43d77c8",null),(0,r.A)(p,"7f2aaa2ba6bebc909c025c6cf9cd6b1622d4761c29",null),(0,r.A)(b,"7fef397480b45af943a71981aace980d42e21b152e",null),(0,r.A)(h,"7fb0a6407a0975390cee39c3e56131848650f040a1",null)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[915,872,273,20],()=>a(77407));module.exports=s})();